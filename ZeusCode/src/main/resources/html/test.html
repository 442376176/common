<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<input type="submit" onclick="post()"/>
</body>
<script type="text/javascript" >
    function post() {
        var arrayObj = new Set([20])
        var Person = {
            tenantName: 'Nike',
            trade: 29,
            socialCreditCode: 29,
            registerCapital: 29,
            legalPerson: 29,
            tenantPhone: 29,
            businessTerm: 29,
            isRent: 29
        }
        for (let i = 0; i < 20; i++) {
            arrayObj.add(Person)
        }

        //创建异步对象
        var xhr = new XMLHttpRequest();
        //设置请求的类型及url
        //post请求一定要添加请求头才行不然会报错
        xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xhr.open('post', 'http://127.0.0.1:8888/api/tenant/tenant/v1/write/tenantExcel');
        //发送请求
        xhr.send(arrayObj);
        xhr.onreadystatechange = function () {
            // 这步为判断服务器是否正确响应
            if (xhr.readyState == 4 && xhr.status == 200) {
                console.log(xhr.responseText);
            }
        };
    };

    function ajax_method() {
        var arrayObj = new Array([20])
        var Person = {
            tenantName: 'Nike',
            trade: 29,
            socialCreditCode: 29,
            registerCapital: 29,
            legalPerson: 29,
            tenantPhone: 29,
            businessTerm: 29,
            isRent: 29
        }
        for (let i = 0; i < 20; i++) {
            arrayObj.add(Person)
        }
        // 异步对象
        var ajax = new XMLHttpRequest();
        var method = 'post';
        var url = 'http://127.0.0.1:8888/api/tenant/tenant/v1/write/tenantExcel';
        ajax.open(method, url);
        // 需要设置请求报文
        ajax.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        // 判断data send发送数据
        if (arrayObj) {
            // 如果有值 从send发送
            ajax.send(arrayObj);
        } else {
            // 木有值 直接发送即可
            ajax.send();
        }
    }

    // // 注册事件
    // ajax.onreadystatechange = function () {
    //     // 在事件中 获取数据 并修改界面显示
    //     if (ajax.readyState == 4 && ajax.status == 200) {
    //         // console.log(ajax.responseText);
    //
    //         // 将 数据 让 外面可以使用
    //         // return ajax.responseText;
    //
    //         // 当 onreadystatechange 调用时 说明 数据回来了
    //         // ajax.responseText;
    //
    //         // 如果说 外面可以传入一个 function 作为参数 success
    //         success(ajax.responseText);
    //     }
    // }


</script>
</html>